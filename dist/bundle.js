(()=>{let e=new Image,t="",a=document.getElementById("debug_msg"),n=document.getElementById("button_container"),s=document.createElement("button"),c=document.createElement("button"),i=!1,d=document.createElement("button"),l=document.getElementById("filtered_canvas"),r=l.getContext("2d"),o=document.createElement("video");async function m(){r.drawImage(o,0,0,1280,720),"grayscale"===t&&(l.classList.contains("grayscale")||l.classList.add("grayscale"),i&&r.drawImage(e,150,200,250,400)),"ar_sticker"===t&&r.drawImage(e,150,200,250,400),"original"===t&&l.classList.contains("grayscale")&&l.classList.remove("grayscale"),requestAnimationFrame(m)}s.classList.add("btn"),s.classList.add("btn-success"),s.classList.add("custom_btn_length"),s.innerText="Grayscale",s.addEventListener("click",(function(){t="grayscale",console.log("switch to grayscale")})),c.classList.add("btn"),c.classList.add("btn-info"),c.classList.add("custom_btn_length"),c.innerText="AR Sticker",c.addEventListener("click",(function(){console.log("switch to ar sticker")})),d.classList.add("btn"),d.classList.add("btn-primary"),d.classList.add("custom_btn_length"),d.innerText="Remove Filters",d.addEventListener("click",(function(){t="original",i=!1,console.log("remove all filters")})),n.appendChild(s),n.appendChild(c),n.appendChild(d),navigator.mediaDevices.getUserMedia({audio:!1,video:{mandatory:{minWidth:1280,maxWidth:1280,minHeight:720,maxHeight:720}}}).then((e=>{a.innerText+="Starting local stream...\n",o.srcObject=e,o.muted=!0,o.play(),m()})).catch((e=>{a.innerText+="[Error] Can't start local stream\n",a.innerText+="[Error] "+e.name+": "+e.message+"\n"}))})();