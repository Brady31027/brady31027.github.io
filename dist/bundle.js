(()=>{let e=new Image,t="",a=document.getElementById("debug_msg"),n=document.getElementById("button_container"),s=document.createElement("button"),c=document.createElement("button"),i=!1,r=document.createElement("button"),d=document.getElementById("filtered_canvas"),l=d.getContext("2d"),o=document.createElement("video");async function m(){l.drawImage(o,0,0,1280,720),"grayscale"===t&&(d.classList.contains("grayscale")||d.classList.add("grayscale"),i&&l.drawImage(e,150,200,250,400)),"ar_sticker"===t&&l.drawImage(e,150,200,250,400),"original"===t&&d.classList.contains("grayscale")&&d.classList.remove("grayscale"),requestAnimationFrame(m)}s.classList.add("btn"),s.classList.add("btn-success"),s.classList.add("custom_btn_length"),s.innerText="Grayscale",s.addEventListener("click",(function(){t="grayscale",console.log("switch to grayscale")})),r.classList.add("btn"),r.classList.add("btn-primary"),r.classList.add("custom_btn_length"),r.innerText="Remove Filters",r.addEventListener("click",(function(){t="original",i=!1,console.log("remove all filters")})),n.appendChild(s),n.appendChild(c),n.appendChild(r),navigator.mediaDevices.getUserMedia({audio:!1,video:{mandatory:{minWidth:1280,maxWidth:1280,minHeight:720,maxHeight:720}}}).then((e=>{a.innerText+="Starting local stream...\n",o.srcObject=e,o.muted=!0,o.play(),m()})).catch((e=>{a.innerText+="[Error] Can't start local stream\n",a.innerText+="[Error] "+e.name+": "+e.message+"\n"}))})();