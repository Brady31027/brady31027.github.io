(()=>{let e=new Image,t="",n=document.getElementById("debug_msg"),a=document.getElementById("button_container"),s=document.createElement("button"),c=document.createElement("button"),i=!1,r=document.createElement("button"),l=document.getElementById("filtered_canvas"),d=l.getContext("2d"),o=document.createElement("video");async function m(){d.drawImage(o,0,0,1280,720),"grayscale"===t&&(l.classList.contains("grayscale")||l.classList.add("grayscale"),i&&d.drawImage(e,150,200,250,400)),"ar_sticker"===t&&d.drawImage(e,150,200,250,400),"original"===t&&l.classList.contains("grayscale")&&l.classList.remove("grayscale"),requestAnimationFrame(m)}s.classList.add("btn"),s.classList.add("btn-success"),s.classList.add("custom_btn_length"),s.innerText="Grayscale",s.addEventListener("click",(function(){t="grayscale",console.log("switch to grayscale")})),c.classList.add("btn"),c.classList.add("btn-info"),c.classList.add("custom_btn_length"),c.innerText="AR Sticker",c.addEventListener("click",(function(){t="ar_sticker",i=!0,console.log("switch to ar sticker")})),r.classList.add("btn"),r.classList.add("btn-primary"),r.classList.add("custom_btn_length"),r.innerText="Remove Filters",r.addEventListener("click",(function(){t="original",i=!1,console.log("remove all filters")})),a.appendChild(s),a.appendChild(c),a.appendChild(r),Promise.all([e.src="img/duck2.png"]).then((()=>{n.innerText+="\n AR image loaded successfully\n",navigator.mediaDevices.getUserMedia({audio:!1,video:{mandatory:{minWidth:1280,maxWidth:1280,minHeight:720,maxHeight:720}}}).then((e=>{n.innerText+="Starting local stream...\n",o.srcObject=e,o.muted=!0,o.play(),m()})).catch((e=>{n.innerText+="[Error] Can't start local stream\n",n.innerText+="[Error] "+e.name+": "+e.message+"\n"}))})).catch((()=>{n.innerText+="\n [Error] Can't load AR image\n"}))})();